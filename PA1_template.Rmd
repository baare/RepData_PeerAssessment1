---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

```
{r setup, include=FALSE}knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
```

### Loading and preprocessing the data
#### 1. Load the data (i.e. read.csv())

Show any code that is needed to

```{r,warning=FALSE}
zipname <- paste(getwd(), "activity.zip", sep = "/")
download.file(url = "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip", zipname)

unzip(zipname, overwrite = TRUE)
filename <- paste(getwd(), "activity.csv", sep = "/")

activity <- read.csv(filename)
```
#### 2. Process/transform the data (if necessary) into a format suitable for your analysis

```{r, warning=FALSE}
dates_activity <- group_by(activity, date)
```

### What is mean total number of steps taken per day?

For this part of the assignment, you can ignore the missing values in the dataset.

#### 1. Calculate the total number of steps taken per day

```{r}
summary_activity <- summarize(dates_activity, total_steps = sum(steps, na.rm = TRUE))
head(summary_activity)
```

#### 2. Make a histogram of the total number of steps taken each day

```{r}
hist(summary_activity$total_steps, breaks = 15)
```
#### 3. Calculate and report the mean and median of the total number of steps taken per day

```{r eval=FALSE}
mean(summary_activity$total_steps)
median(summary_activity$total_steps)
```
The mean of of the total number of steps taken per day is `r mean(summary_activity$total_steps)`.
The median of of the total number of steps taken per day is `r median(summary_activity$total_steps)`.

### What is the average daily activity pattern?

#### 1.Make a time series plot of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)

```{r}
interval_activity <- group_by(activity, interval)
steps_interval <- summarize(interval_activity, average_steps = mean(steps, na.rm = TRUE))
average_steps <- ts(steps_interval$average_steps)
plot.ts(average_steps)
```
#### 2.Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?

```{r}
interval_activity <- group_by(activity, interval)
steps_interval <- summarize(interval_activity, average_steps = mean(steps, na.rm = TRUE))
result <- steps_interval %>% filter(average_steps == max(average_steps))
result
```
Interval **`r result$interval`** contains the maximum steps (average across all the days in the dataset).Â  

### Imputing missing values

#### 1.Calculate and report the total number of missing values in the dataset (i.e. the total number of rows with NAs)

```{r eval=FALSE}
sum(is.na(activity$steps))
```
There are **`r sum(is.na(activity$steps))`** rows with NAs.

## Imputing missing values




## Are there differences in activity patterns between weekdays and weekends?
